<h2>Launch <%= @samples.size %> RNA-Seq Pipelines for Samples:</h2>

<% form_for :post_pipeline, :url=>{:controller=>:post_pipelines, :action=>:launch_multi, :id=>nil} do |form| %>

<table>
<% @samples.each do |sample| %>
<tr>
    <td><%= check_box_tag 'selected_samples[]', sample.id.to_s, true, {:id=>"sample_#{sample.id.to_s}"} %></td>
    <td><%= link_to sample.name_on_tube, edit_sample_path(sample) %></td>
    <td>(<%= sample.real_read_length %>, <%= sample.status %>, <%= sample.sample_prep_kit.name %>, 
<%= 
begin 
  @ref_genome_name=sample.rna_seq_ref_genome.name 
rescue Exception => e
  @disable_launch=true
  @why_disabled='No reference genome for some samples'
  e.message
end
%>)</td>
    <td><%= render :partial=> 'experiments/pps_for_sample', :locals => { :sample=>sample } %></td>
<% end %>
</table>

<%= render :partial => 'experiments/post_pipeline_params', :locals => {:sample => @samples[0], :email=>@email } %>

<% if @disable_launch %>
<p>
  The RNASeq pipeline cannot be run on this sample: <br /><%= @why_disabled %></p>
<% end %>
<p><%= form.submit "Launch Pipeline", :disabled=>@disable_launch %></p>

<% end %>